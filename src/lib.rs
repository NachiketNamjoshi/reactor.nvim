use std::collections::HashMap;

use nvim_oxi::{self as oxi, api, opts::*};

#[oxi::module]
fn reactor() -> oxi::Result<()> {
    api::set_option("termguicolors", true)?;
    let reactor: HashMap<i32, String> = get_colors();
    macro_rules! sethl {
        ($hlname: expr, $fgcol: expr, $bgcol: expr) => {
            api::set_hl(
                0,
                stringify!($hlname),
                Some(
                    &SetHighlightOpts::builder()
                        .fg(reactor.get($fgcol).unwrap())
                        .bg(reactor.get($bgcol).unwrap())
                        .build(),
                ),
            )?;
        };
        ($hlname: expr, $fgcol: expr, $bgcol: expr, $key: ident) => {
            api::set_hl(
                0,
                stringify!($hlname),
                Some(
                    &SetHighlightOpts::builder()
                        .fg(reactor.get($fgcol).unwrap())
                        .bg(reactor.get($bgcol).unwrap())
                        .$key(true)
                        .build(),
                ),
            )?;
        };
    }

    api::set_var("terminal_color_background", reactor.get(&0).unwrap().to_string())?;
    api::set_var("terminal_color_foreground", reactor.get(&15).unwrap().to_string())?;

    api::set_var("terminal_color_0", reactor.get(&0).unwrap().to_string())?;
    api::set_var("terminal_color_1", reactor.get(&1).unwrap().to_string())?;
    api::set_var("terminal_color_2", reactor.get(&2).unwrap().to_string())?;
    api::set_var("terminal_color_3", reactor.get(&3).unwrap().to_string())?;
    api::set_var("terminal_color_4", reactor.get(&4).unwrap().to_string())?;
    api::set_var("terminal_color_5", reactor.get(&5).unwrap().to_string())?;
    api::set_var("terminal_color_6", reactor.get(&6).unwrap().to_string())?;
    api::set_var("terminal_color_7", reactor.get(&7).unwrap().to_string())?;
    api::set_var("terminal_color_8", reactor.get(&8).unwrap().to_string())?;
    api::set_var("terminal_color_9", reactor.get(&9).unwrap().to_string())?;
    api::set_var("terminal_color_10", reactor.get(&10).unwrap().to_string())?;
    api::set_var("terminal_color_11", reactor.get(&11).unwrap().to_string())?;
    api::set_var("terminal_color_12", reactor.get(&12).unwrap().to_string())?;
    api::set_var("terminal_color_13", reactor.get(&13).unwrap().to_string())?;
    api::set_var("terminal_color_14", reactor.get(&14).unwrap().to_string())?;
    api::set_var("terminal_color_15", reactor.get(&15).unwrap().to_string())?;

    // Telescope Plugin
    sethl!(TelescopeSelection, &32, &236);
    sethl!(TelescopeMatching, &228, &999, bold);
    sethl!(TelescopeBorder, &4, &0);

    // Basics
    sethl!(Normal, &15, &0);
    sethl!(SignColumn, &999, &237);
    sethl!(MsgArea, &15, &235);
    sethl!(ModeMsg, &15, &235);
    sethl!(MsgSeparator, &15, &235);
    sethl!(SpellBad, &9, &235, underline);
    sethl!(SpellCap, &3, &999, underline);
    sethl!(SpellLocal, &2, &999, underline);
    sethl!(SpellRare, &5, &999, underline);
    sethl!(NormalNC, &15, &0);
    sethl!(Pmenu, &248, &234);
    sethl!(PmenuSel, &0, &73, bold);
    sethl!(WildMenu, &0, &73);
    sethl!(CursorLineNr, &251, &235, bold);
    sethl!(Comment, &245, &999);
    sethl!(Folded, &68, &234);
    sethl!(FoldColumn, &68, &234);
    sethl!(LineNr, &249, &999);
    sethl!(FloatBoder, &249, &234);
    sethl!(Whitespace, &999, &999);
    sethl!(VertSplit, &249, &0);
    sethl!(CursorLine, &999, &236);
    sethl!(CursorColumn, &999, &236);
    sethl!(ColorColumn, &999, &236);
    sethl!(NormalFloat, &999, &236);
    sethl!(Visual, &999, &239);
    sethl!(VisualNOS, &999, &234);
    sethl!(WarningMsg, &1, &0, bold);
    sethl!(DiffAdd, &234, &10);
    sethl!(DiffChange, &234, &11, underline);
    sethl!(DiffDelete, &234, &125);
    sethl!(QuickFixLine, &15, &73);
    sethl!(PmenuSbar, &999, &234);
    sethl!(PmenuThumb, &999, &242);
    sethl!(MatchWord, &999, &999, underline);
    sethl!(MatchParen, &70, &0, underline);
    sethl!(MatchWordCur, &249, &235, underline);
    sethl!(MatchParenCur, &70, &0, underline);
    sethl!(Cursor, &235, &253);
    sethl!(lCursor, &235, &253);
    sethl!(CursorIM, &235, &253);
    sethl!(TermCursor, &235, &253);
    sethl!(TermCursorNC, &235, &253);
    sethl!(Conceal, &68, &0);
    sethl!(Directory, &4, &999);
    sethl!(SpecialKey, &4, &999, bold);
    sethl!(Title, &4, &999, bold);
    sethl!(ErrorMsg, &1, &0, bold);
    sethl!(Search, &250, &60, bold);
    sethl!(IncSearch, &208, &236, bold);
    sethl!(Substitute, &208, &236, underline);
    sethl!(MoreMsg, &173, &999);
    sethl!(Question, &173, &999);
    sethl!(EndOfBuffer, &999, &0);
    sethl!(NonText, &999, &0);
    sethl!(Variable, &6, &999);
    sethl!(String, &2, &999);
    sethl!(Character, &2, &999, bold);
    sethl!(Constant, &4, &999);
    sethl!(Number, &146, &999);
    sethl!(Boolean, &111, &999);
    sethl!(Float,&146, &999);
    sethl!(Identifier, &2, &999);
    sethl!(Function, &11, &999);
    sethl!(Operator, &15, &999);
    sethl!(Type, &108, &999);
    sethl!(StorageClass, &9, &999);
    sethl!(Structure, &36, &999);
    sethl!(Typedef, &108, &999);
    sethl!(Keyword, &38, &999);
    sethl!(Statement, &13, &999);
    sethl!(Conditional, &14, &999);
    sethl!(Repeat, &14, &999);
    sethl!(Label, &14, &999);
    sethl!(Exception, &14, &999);
    sethl!(Include, &14, &999);
    sethl!(PreProc, &14, &999);
    sethl!(Define, &14, &999);
    sethl!(Macro, &14, &999);
    sethl!(PreCondit, &14, &999);
    sethl!(Special, &166, &999, bold);
    sethl!(SpecialChar, &15, &999);
    sethl!(Tag, &109, &235);
    sethl!(Debug, &1, &8);
    sethl!(Delimiter, &249, &999);
    sethl!(SpecialComment, &249, &999);
    sethl!(Ignore, &4, &0, bold);
    sethl!(Todo, &13, &0, bold);
    sethl!(Error, &1, &0, bold);
    sethl!(TabLine, &250, &234);
    sethl!(TabLineSel, &15, &234, bold);
    sethl!(TabLineFill, &249, &234);
    Ok(())
}


fn get_colors() -> HashMap<i32, String> {
    let mut colorlist: HashMap<i32, String> = HashMap::new();
    colorlist.insert(0, String::from("#212121"));
    colorlist.insert(1, String::from("#99412f"));
    colorlist.insert(2, String::from("#8c9440"));
    colorlist.insert(3, String::from("#ca904f"));
    colorlist.insert(4, String::from("#32888b"));
    colorlist.insert(5, String::from("#815d7b"));
    colorlist.insert(6, String::from("#068488"));
    colorlist.insert(7, String::from("#707880"));
    colorlist.insert(8, String::from("#373b41"));
    colorlist.insert(9, String::from("#d6806e"));
    colorlist.insert(10, String::from("#b5bd68"));
    colorlist.insert(11, String::from("#fbb566"));
    colorlist.insert(12, String::from("#2aabbb"));
    colorlist.insert(13, String::from("#bc81b2"));
    colorlist.insert(14, String::from("#00c6cf"));
    colorlist.insert(15, String::from("#faf8ff"));
    colorlist.insert(16, String::from("#000000"));
    colorlist.insert(17, String::from("#00005f"));
    colorlist.insert(18, String::from("#000087"));
    colorlist.insert(19, String::from("#0000af"));
    colorlist.insert(20, String::from("#0000d7"));
    colorlist.insert(21, String::from("#0000ff"));
    colorlist.insert(22, String::from("#005f00"));
    colorlist.insert(23, String::from("#005f5f"));
    colorlist.insert(24, String::from("#005f87"));
    colorlist.insert(25, String::from("#005faf"));
    colorlist.insert(26, String::from("#005fd7"));
    colorlist.insert(27, String::from("#005fff"));
    colorlist.insert(28, String::from("#008700"));
    colorlist.insert(29, String::from("#00875f"));
    colorlist.insert(30, String::from("#008787"));
    colorlist.insert(31, String::from("#0087af"));
    colorlist.insert(32, String::from("#0087d7"));
    colorlist.insert(33, String::from("#0087ff"));
    colorlist.insert(34, String::from("#00af00"));
    colorlist.insert(35, String::from("#00af5f"));
    colorlist.insert(36, String::from("#00af87"));
    colorlist.insert(37, String::from("#00afaf"));
    colorlist.insert(38, String::from("#00afd7"));
    colorlist.insert(39, String::from("#00afff"));
    colorlist.insert(40, String::from("#00d700"));
    colorlist.insert(41, String::from("#00d75f"));
    colorlist.insert(42, String::from("#00d787"));
    colorlist.insert(43, String::from("#00d7af"));
    colorlist.insert(44, String::from("#00d7d7"));
    colorlist.insert(45, String::from("#00d7ff"));
    colorlist.insert(46, String::from("#00ff00"));
    colorlist.insert(47, String::from("#00ff5f"));
    colorlist.insert(48, String::from("#00ff87"));
    colorlist.insert(49, String::from("#00ffaf"));
    colorlist.insert(50, String::from("#00ffd7"));
    colorlist.insert(51, String::from("#00ffff"));
    colorlist.insert(52, String::from("#5f0000"));
    colorlist.insert(53, String::from("#5f005f"));
    colorlist.insert(54, String::from("#5f0087"));
    colorlist.insert(55, String::from("#5f00af"));
    colorlist.insert(56, String::from("#5f00d7"));
    colorlist.insert(57, String::from("#5f00ff"));
    colorlist.insert(58, String::from("#5f5f00"));
    colorlist.insert(59, String::from("#5f5f5f"));
    colorlist.insert(60, String::from("#5f5f87"));
    colorlist.insert(61, String::from("#5f5faf"));
    colorlist.insert(62, String::from("#5f5fd7"));
    colorlist.insert(63, String::from("#5f5fff"));
    colorlist.insert(64, String::from("#5f8700"));
    colorlist.insert(65, String::from("#5f875f"));
    colorlist.insert(66, String::from("#5f8787"));
    colorlist.insert(67, String::from("#5f87af"));
    colorlist.insert(68, String::from("#5f87d7"));
    colorlist.insert(69, String::from("#5f87ff"));
    colorlist.insert(70, String::from("#5faf00"));
    colorlist.insert(71, String::from("#5faf5f"));
    colorlist.insert(72, String::from("#5faf87"));
    colorlist.insert(73, String::from("#5fafaf"));
    colorlist.insert(74, String::from("#5fafd7"));
    colorlist.insert(75, String::from("#5fafff"));
    colorlist.insert(76, String::from("#5fd700"));
    colorlist.insert(77, String::from("#5fd75f"));
    colorlist.insert(78, String::from("#5fd787"));
    colorlist.insert(79, String::from("#5fd7af"));
    colorlist.insert(80, String::from("#5fd7d7"));
    colorlist.insert(81, String::from("#5fd7ff"));
    colorlist.insert(82, String::from("#5fff00"));
    colorlist.insert(83, String::from("#5fff5f"));
    colorlist.insert(84, String::from("#5fff87"));
    colorlist.insert(85, String::from("#5fffaf"));
    colorlist.insert(86, String::from("#5fffd7"));
    colorlist.insert(87, String::from("#5fffff"));
    colorlist.insert(88, String::from("#870000"));
    colorlist.insert(89, String::from("#87005f"));
    colorlist.insert(90, String::from("#870087"));
    colorlist.insert(91, String::from("#8700af"));
    colorlist.insert(92, String::from("#8700d7"));
    colorlist.insert(93, String::from("#8700ff"));
    colorlist.insert(94, String::from("#875f00"));
    colorlist.insert(95, String::from("#875f5f"));
    colorlist.insert(96, String::from("#875f87"));
    colorlist.insert(97, String::from("#875faf"));
    colorlist.insert(98, String::from("#875fd7"));
    colorlist.insert(99, String::from("#875fff"));
    colorlist.insert(100, String::from("#878700"));
    colorlist.insert(101, String::from("#87875f"));
    colorlist.insert(102, String::from("#878787"));
    colorlist.insert(103, String::from("#8787af"));
    colorlist.insert(104, String::from("#8787d7"));
    colorlist.insert(105, String::from("#8787ff"));
    colorlist.insert(106, String::from("#87af00"));
    colorlist.insert(107, String::from("#87af5f"));
    colorlist.insert(108, String::from("#87af87"));
    colorlist.insert(109, String::from("#87afaf"));
    colorlist.insert(110, String::from("#87afd7"));
    colorlist.insert(111, String::from("#87afff"));
    colorlist.insert(112, String::from("#87d700"));
    colorlist.insert(113, String::from("#87d75f"));
    colorlist.insert(114, String::from("#87d787"));
    colorlist.insert(115, String::from("#87d7af"));
    colorlist.insert(116, String::from("#87d7d7"));
    colorlist.insert(117, String::from("#87d7ff"));
    colorlist.insert(118, String::from("#87ff00"));
    colorlist.insert(119, String::from("#87ff5f"));
    colorlist.insert(120, String::from("#87ff87"));
    colorlist.insert(121, String::from("#87ffaf"));
    colorlist.insert(122, String::from("#87ffd7"));
    colorlist.insert(123, String::from("#87ffff"));
    colorlist.insert(124, String::from("#af0000"));
    colorlist.insert(125, String::from("#af005f"));
    colorlist.insert(126, String::from("#af0087"));
    colorlist.insert(127, String::from("#af00af"));
    colorlist.insert(128, String::from("#af00d7"));
    colorlist.insert(129, String::from("#af00ff"));
    colorlist.insert(130, String::from("#af5f00"));
    colorlist.insert(131, String::from("#af5f5f"));
    colorlist.insert(132, String::from("#af5f87"));
    colorlist.insert(133, String::from("#af5faf"));
    colorlist.insert(134, String::from("#af5fd7"));
    colorlist.insert(135, String::from("#af5fff"));
    colorlist.insert(136, String::from("#af8700"));
    colorlist.insert(137, String::from("#af875f"));
    colorlist.insert(138, String::from("#af8787"));
    colorlist.insert(139, String::from("#af87af"));
    colorlist.insert(140, String::from("#af87d7"));
    colorlist.insert(141, String::from("#af87ff"));
    colorlist.insert(142, String::from("#afaf00"));
    colorlist.insert(143, String::from("#afaf5f"));
    colorlist.insert(144, String::from("#afaf87"));
    colorlist.insert(145, String::from("#afafaf"));
    colorlist.insert(146, String::from("#afafd7"));
    colorlist.insert(147, String::from("#afafff"));
    colorlist.insert(148, String::from("#afd700"));
    colorlist.insert(149, String::from("#afd75f"));
    colorlist.insert(150, String::from("#afd787"));
    colorlist.insert(151, String::from("#afd7af"));
    colorlist.insert(152, String::from("#afd7d7"));
    colorlist.insert(153, String::from("#afd7ff"));
    colorlist.insert(154, String::from("#afff00"));
    colorlist.insert(155, String::from("#afff5f"));
    colorlist.insert(156, String::from("#afff87"));
    colorlist.insert(157, String::from("#afffaf"));
    colorlist.insert(158, String::from("#afffd7"));
    colorlist.insert(159, String::from("#afffff"));
    colorlist.insert(160, String::from("#d70000"));
    colorlist.insert(161, String::from("#d7005f"));
    colorlist.insert(162, String::from("#d70087"));
    colorlist.insert(163, String::from("#d700af"));
    colorlist.insert(164, String::from("#d700d7"));
    colorlist.insert(165, String::from("#d700ff"));
    colorlist.insert(166, String::from("#d75f00"));
    colorlist.insert(167, String::from("#d75f5f"));
    colorlist.insert(168, String::from("#d75f87"));
    colorlist.insert(169, String::from("#d75faf"));
    colorlist.insert(170, String::from("#d75fd7"));
    colorlist.insert(171, String::from("#d75fff"));
    colorlist.insert(172, String::from("#d78700"));
    colorlist.insert(173, String::from("#d7875f"));
    colorlist.insert(174, String::from("#d78787"));
    colorlist.insert(175, String::from("#d787af"));
    colorlist.insert(176, String::from("#d787d7"));
    colorlist.insert(177, String::from("#d787ff"));
    colorlist.insert(178, String::from("#d7af00"));
    colorlist.insert(179, String::from("#d7af5f"));
    colorlist.insert(180, String::from("#d7af87"));
    colorlist.insert(181, String::from("#d7afaf"));
    colorlist.insert(182, String::from("#d7afd7"));
    colorlist.insert(183, String::from("#d7afff"));
    colorlist.insert(184, String::from("#d7d700"));
    colorlist.insert(185, String::from("#d7d75f"));
    colorlist.insert(186, String::from("#d7d787"));
    colorlist.insert(187, String::from("#d7d7af"));
    colorlist.insert(188, String::from("#d7d7d7"));
    colorlist.insert(189, String::from("#d7d7ff"));
    colorlist.insert(190, String::from("#d7ff00"));
    colorlist.insert(191, String::from("#d7ff5f"));
    colorlist.insert(192, String::from("#d7ff87"));
    colorlist.insert(193, String::from("#d7ffaf"));
    colorlist.insert(194, String::from("#d7ffd7"));
    colorlist.insert(195, String::from("#d7ffff"));
    colorlist.insert(196, String::from("#ff0000"));
    colorlist.insert(197, String::from("#ff005f"));
    colorlist.insert(198, String::from("#ff0087"));
    colorlist.insert(199, String::from("#ff00af"));
    colorlist.insert(200, String::from("#ff00d7"));
    colorlist.insert(201, String::from("#ff00ff"));
    colorlist.insert(202, String::from("#ff5f00"));
    colorlist.insert(203, String::from("#ff5f5f"));
    colorlist.insert(204, String::from("#ff5f87"));
    colorlist.insert(205, String::from("#ff5faf"));
    colorlist.insert(206, String::from("#ff5fd7"));
    colorlist.insert(207, String::from("#ff5fff"));
    colorlist.insert(208, String::from("#ff8700"));
    colorlist.insert(209, String::from("#ff875f"));
    colorlist.insert(210, String::from("#ff8787"));
    colorlist.insert(211, String::from("#ff87af"));
    colorlist.insert(212, String::from("#ff87d7"));
    colorlist.insert(213, String::from("#ff87ff"));
    colorlist.insert(214, String::from("#ffaf00"));
    colorlist.insert(215, String::from("#ffaf5f"));
    colorlist.insert(216, String::from("#ffaf87"));
    colorlist.insert(217, String::from("#ffafaf"));
    colorlist.insert(218, String::from("#ffafd7"));
    colorlist.insert(219, String::from("#ffafff"));
    colorlist.insert(220, String::from("#ffd700"));
    colorlist.insert(221, String::from("#ffd75f"));
    colorlist.insert(222, String::from("#ffd787"));
    colorlist.insert(223, String::from("#ffd7af"));
    colorlist.insert(224, String::from("#ffd7d7"));
    colorlist.insert(225, String::from("#ffd7ff"));
    colorlist.insert(226, String::from("#ffff00"));
    colorlist.insert(227, String::from("#ffff5f"));
    colorlist.insert(228, String::from("#ffff87"));
    colorlist.insert(229, String::from("#ffffaf"));
    colorlist.insert(230, String::from("#ffffd7"));
    colorlist.insert(231, String::from("#ffffff"));
    colorlist.insert(232, String::from("#080808"));
    colorlist.insert(233, String::from("#121212"));
    colorlist.insert(234, String::from("#1c1c1c"));
    colorlist.insert(235, String::from("#262626"));
    colorlist.insert(236, String::from("#303030"));
    colorlist.insert(237, String::from("#3a3a3a"));
    colorlist.insert(238, String::from("#444444"));
    colorlist.insert(239, String::from("#4e4e4e"));
    colorlist.insert(240, String::from("#585858"));
    colorlist.insert(241, String::from("#626262"));
    colorlist.insert(242, String::from("#6c6c6c"));
    colorlist.insert(243, String::from("#767676"));
    colorlist.insert(244, String::from("#808080"));
    colorlist.insert(245, String::from("#8a8a8a"));
    colorlist.insert(246, String::from("#949494"));
    colorlist.insert(247, String::from("#9e9e9e"));
    colorlist.insert(248, String::from("#a8a8a8"));
    colorlist.insert(249, String::from("#b2b2b2"));
    colorlist.insert(250, String::from("#bcbcbc"));
    colorlist.insert(251, String::from("#c6c6c6"));
    colorlist.insert(252, String::from("#d0d0d0"));
    colorlist.insert(253, String::from("#dadada"));
    colorlist.insert(254, String::from("#e4e4e4"));
    colorlist.insert(255, String::from("#eeeeee"));
    colorlist.insert(999, String::from(""));
    return colorlist;
}
